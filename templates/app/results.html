<!DOCTYPE html>
<html lang="en" class="selection:bg-[#fca5a5] selection:text-black scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audit: {{ audit.url | replace('https://', '') | replace('http://', '') }} | FixMyLanding</title>
  <meta name="description" content="Audit results for {{ audit.url | replace('https://', '') | replace('http://', '') }}.">
  <meta name="robots" content="noindex,nofollow">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Audit: {{ audit.url | replace('https://', '') | replace('http://', '') }} | FixMyLanding">
  <meta property="og:description" content="Audit results for {{ audit.url | replace('https://', '') | replace('http://', '') }}.">
  <meta property="og:image" content="{{ url_for('static', filename='imgs/og-image.png') }}">
  <meta property="og:image:alt" content="FixMyLanding preview">
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer data-website-id="dfid_5CENfXdlBU0wZKBoKOxd4" data-domain="fixmyland.ing" src="https://datafa.st/js/script.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='imgs/favicon.ico') }}">
  <style>
    :root { --bg:#1F1F1F; --s:#2a2a2a; --s2:#333; --b:#444; --a:#fca5a5; --t:#e5e5e5; --tm:#999; }
    * { box-sizing:border-box; }
    body { background:var(--bg); color:var(--t); font-family:'Bricolage Grotesque',sans-serif; margin:0; }
    .fm { font-family:'JetBrains Mono',monospace; }
    .ring { transform:rotate(-90deg); }
    .ring-t { stroke:var(--s2); }
    .ring-f { transition:stroke-dashoffset 1s ease-out; }
    .issue-row:hover { background:rgba(252,165,165,0.04); }
    .tab-btn.active { background:var(--a); color:#000; border-color:var(--b); }
    .tab-c { display:none; }
    .tab-c.active { display:block; }
    .sev-critical { color:#ef4444; }
    .sev-high { color:#f97316; }
    .sev-medium { color:#f59e0b; }
    .sev-low { color:#3b82f6; }
    .dot-critical { background:#ef4444; }
    .dot-high { background:#f97316; }
    .dot-medium { background:#f59e0b; }
    .dot-low { background:#3b82f6; }
    .dot-passed { background:#22c55e; }
    .dot-warning { background:#f59e0b; }
    .dot-failed { background:#ef4444; }
    .bar { transition:width 1s ease-out; }
    @keyframes fadeUp { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
    .fade-up { animation:fadeUp .5s ease-out both; }
    .fade-up-1 { animation-delay:.05s; }
    .fade-up-2 { animation-delay:.1s; }
    .fade-up-3 { animation-delay:.15s; }
    .fade-up-4 { animation-delay:.2s; }
    .no-blue-outline *:focus { outline: none; box-shadow: none; }
    .score-box { outline: none; box-shadow: none; }
    .blurred-text { filter: blur(6px); user-select: none; pointer-events: none; }

  </style>
</head>
<body class="min-h-screen relative">
<div class="paper-grid"></div>
<div class="noise-overlay"></div>

{% set domain = audit.url | replace('https://', '') | replace('http://', '') %}
{% if domain.endswith('/') %}{% set domain = domain[:-1] %}{% endif %}
{% set dur = (audit.scan_duration_ms / 1000) | round(1) %}
{% set s = audit.scores %}
{% set pw = (audit.get('performance', {}).get('page_weight', {}) if audit.get('performance') else {}) %}
{% set safe_total_kb = pw.get('total_kb', 1) if pw else 1 %}
{% set limited_view = limited_view | default(false) %}
{% set force_blur = force_blur | default(false) %}
{% set require_login = require_login | default(false) %}
{% set obfuscate = obfuscate | default(false) %}
{% set blurred = require_login or force_blur %}
{% set ns = namespace(total=0, critical=0, high=0, medium=0, low=0, cats={}) %}
{% for item in audit.issues['items'] if item is mapping %}
  {% set ns.total = ns.total + 1 %}
  {% if item.severity == 'critical' %}{% set ns.critical = ns.critical + 1 %}{% endif %}
  {% if item.severity == 'high' %}{% set ns.high = ns.high + 1 %}{% endif %}
  {% if item.severity == 'medium' %}{% set ns.medium = ns.medium + 1 %}{% endif %}
  {% if item.severity == 'low' %}{% set ns.low = ns.low + 1 %}{% endif %}
  {% if item.category %}
    {% set ns.cats = ns.cats.update({item.category: (ns.cats.get(item.category, 0) + 1)}) or ns.cats %}
  {% else %}
    {% set ns.cats = ns.cats.update({'other': (ns.cats.get('other', 0) + 1)}) or ns.cats %}
  {% endif %}
{% endfor %}
{% set safe_total = ns.total if ns.total else 1 %}

<!-- Nav -->
<nav class="border-b border-[#333] bg-[#2a2a2a] px-4 md:px-8 py-4 flex items-center justify-between sticky top-0 z-50">
  <a href="/"><span class="text-xl md:text-2xl font-black tracking-tighter text-white">fixmy<span class="text-[#fca5a5]">land<span class="text-white">.</span>ing</span></a>
  <div class="flex items-center gap-4">
    {% if share_url %}
    <button onclick="copyShareLink()" id="share-btn" class="hidden md:flex items-center gap-2 text-gray-400 hover:text-white text-sm fm transition-colors"><i data-lucide="link" class="w-4 h-4"></i> <span id="share-btn-text">Share</span></button>
    {% endif %}
    {% if require_login %}
    <a href="/signup{% if shared_audit_id %}?shared={{ shared_audit_id }}{% endif %}" class="bg-[#fca5a5] text-black px-4 py-2 fm text-xs font-bold border-2 border-[#444] shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">SIGN UP TO VIEW</a>
    {% endif %}
    <a href="/" class="bg-[#fca5a5] text-black px-4 py-2 fm text-xs font-bold border-2 border-[#444] shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">NEW AUDIT</a>
  </div>
</nav>

<!-- Header -->
<header class="px-4 md:px-8 py-8 md:py-10 border-b border-[#333]">
  <div class="max-w-7xl mx-auto flex flex-col md:flex-row md:items-center justify-between gap-4">
    <div>
      <p class="fm text-[10px] text-gray-500 uppercase mb-2">Audit Report</p>
      <h1 class="text-2xl md:text-4xl font-black text-white flex items-center gap-3">
        <img src="https://www.google.com/s2/favicons?domain={{ domain }}&sz=64" class="w-8 h-8 rounded" alt="">
        {{ domain }}
      </h1>
      <p class="text-gray-500 fm text-sm mt-2">{{ '2026-01-01' if obfuscate else ((audit.created_at[:10] if audit.created_at else audit.scanned_at[:10])) }} &middot; {{ (9.9 if obfuscate else dur) }}s scan &middot; {{ ('B' if obfuscate else s.overall.grade) }} grade</p>
      <p class="text-gray-400 text-sm mt-1">{{ 'Sign in to view the full audit details.' if blurred else ('High-level audit summary is hidden until you sign in.' if obfuscate else s.overall.summary) }}</p>
    </div>
    <div class="flex items-center gap-2 flex-wrap">
      <span class="bg-[#333] text-gray-400 px-3 py-1 fm text-[10px] border border-[#444]">{{ (9.9 if obfuscate else dur) }}s scan</span>
      <span class="bg-[#333] text-gray-400 px-3 py-1 fm text-[10px] border border-[#444]">{{ (3.7 if obfuscate else ((pw.get('total_kb', 0) / 1024) | round(1))) }} MB</span>
    </div>
  </div>
</header>

<main class="max-w-7xl mx-auto px-4 md:px-8 py-8 md:py-10 no-blue-outline">

{% if require_login %}
<section class="mb-8">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-4 md:p-5">
    <p class="fm text-[10px] uppercase tracking-widest text-gray-500 mb-1">Sign In Required</p>
    <p class="text-sm text-gray-300">Create an account or sign in to view the full report.</p>
    <a href="/login{% if shared_audit_id %}?shared={{ shared_audit_id }}{% endif %}" class="mt-3 inline-block bg-[#fca5a5] text-black px-4 py-2 font-bold border-2 border-[#444] shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">Sign In</a>
    <a href="/signup{% if shared_audit_id %}?shared={{ shared_audit_id }}{% endif %}" class="mt-3 ml-2 inline-block bg-[#fca5a5] text-black px-5 py-2.5 font-black border-2 border-[#444] shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">Sign Up</a>
  </div>
</section>
{% endif %}

<div class="{% if blurred %}blurred-text{% endif %}">

{% if audit.metadata.upgrade_required %}
<section class="mb-8">
  <div class="bg-[#fca5a5] text-black border-2 border-[#444] p-4 md:p-5 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]">
    <p class="fm text-[10px] uppercase tracking-widest mb-1">Upgrade Required</p>
    <p class="font-bold text-lg">This website is too large for the free scan.</p>
    <p class="text-sm">Upgrade to scan full pages and unlock complete results.</p>
  </div>
</section>

<section class="mb-10">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6 md:p-8 text-center">
    <span class="inline-block bg-[#fca5a5] text-black px-3 py-1 border border-[#444] fm text-[10px] font-bold mb-3">PRO</span>
    <h3 class="text-2xl md:text-3xl font-black text-white mb-2">15 Full-Page Scans / Month</h3>
    <p class="text-gray-400 mb-6">Get complete audits, full copy changes, and scan large websites with an advanced AI model.</p>
    <a href="/billing/checkout" onclick="window?.datafast?.('upgrade_clicked')" class="bg-[#fca5a5] text-black px-8 py-3 font-bold border-2 border-[#444] shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all inline-block">Upgrade Now</a>
  </div>
</section>

{% else %}
{% if audit.metadata.model_limit %}
<section class="mb-8">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-4 md:p-5">
    <p class="fm text-[10px] uppercase tracking-widest text-gray-500 mb-1">Model Limit</p>
    <p class="text-sm text-gray-300">This is a model capacity limit, not a plan limit. We’ll upgrade it soon.</p>
  </div>
</section>
{% endif %}

{% if limited_view %}
<section class="mb-8">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-4 md:p-5">
    <p class="fm text-[10px] uppercase tracking-widest text-gray-500 mb-1">Limited View</p>
    <p class="text-sm text-gray-300">Some copy suggestions and code fixes are hidden. Upgrade to view the full report.</p>
    <a href="/billing/checkout" onclick="window?.datafast?.('upgrade_clicked')" class="mt-3 inline-block bg-[#fca5a5] text-black px-4 py-2 font-bold border-2 border-[#444] shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">Upgrade to Pro</a>
  </div>
</section>
{% endif %}

<!-- Scores -->
<section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-10">
  <!-- Overall ring -->
  <div class="score-box bg-[#2a2a2a] p-8 flex flex-col items-center justify-center fade-up outline-none">
    <p class="fm text-[10px] text-gray-500 uppercase mb-5">Overall Score</p>
    {% set os = s.overall.score %}
    {% set circ = 326.73 %}
    {% set off = circ - (circ * os / 100) %}
    {% if os >= 80 %}{% set sc = '#22c55e' %}{% elif os >= 60 %}{% set sc = '#f59e0b' %}{% else %}{% set sc = '#ef4444' %}{% endif %}
    <div class="relative w-44 h-44">
      <svg viewBox="0 0 120 120" class="w-full h-full"><circle cx="60" cy="60" r="52" fill="none" stroke-width="10" class="ring-t"/><circle cx="60" cy="60" r="52" fill="none" stroke-width="10" stroke="{{ sc }}" stroke-dasharray="{{ circ }}" stroke-dashoffset="{{ off }}" stroke-linecap="round" class="ring-f"/></svg>
      <div class="absolute inset-0 flex flex-col items-center justify-center"><span class="text-5xl font-black text-white">{{ 78 if obfuscate else os }}</span><span class="text-sm text-gray-500 fm">/100</span></div>
    </div>
    <p class="mt-4 fm text-xs text-gray-500">Grade: <span class="text-white font-bold">{{ s.overall.grade }}</span></p>
  </div>

  <!-- Category score grid -->
  <div class="score-box bg-[#2a2a2a] border-2 border-[#444] p-8 grid grid-cols-2 gap-4 fade-up fade-up-2">
    {% for cat, label in [('seo','SEO'),('conversion','Conversion'),('security','Security'),('domain','Domain')] %}
    {% set cat_stats = (s.get(cat) if s is mapping else None) or {} %}
    {% set missing_domain = (cat == 'domain' and not cat_stats) %}
    {% set cs = cat_stats.get('score', 0) %}
    {% if cs >= 80 %}{% set cc = '#22c55e' %}{% elif cs >= 60 %}{% set cc = '#f59e0b' %}{% else %}{% set cc = '#ef4444' %}{% endif %}
    <div class="bg-[#1F1F1F] border border-[#444] p-4 flex flex-col justify-between min-h-[110px]">
      <div class="flex items-center justify-between">
        <span class="fm text-[10px] uppercase text-gray-400">{{ label }}</span>
        <span class="fm text-[10px] uppercase" style="color:{{ cc }}">{{ '-' if missing_domain else cat_stats.get('grade', 'N/A') }}</span>
      </div>
      <div class="flex items-end justify-between">
        <span class="text-3xl font-black text-white">{{ (72 if loop.index == 1 else 74) if obfuscate else ('-' if missing_domain else cs) }}</span>
        <span class="text-[10px] text-gray-500 fm">{{ '-&#10003; -&#10007; -&#9888;' | safe if missing_domain else (cat_stats.get('passed', 0) ~ '&#10003; ' ~ cat_stats.get('failed', 0) ~ '&#10007; ' ~ cat_stats.get('warnings', 0) ~ '&#9888;') | safe }}</span>
      </div>
    </div>
    {% endfor %}
  </div>
</section>

<!-- Domain Rating -->
<section class="mb-10 fade-up fade-up-3">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6 md:p-8">
    <div class="flex items-center gap-2 mb-4">
      <i data-lucide="globe" class="w-5 h-5 text-[#fca5a5]"></i>
      <h3 class="text-xl font-black text-white">Domain Rating</h3>
    </div>
    {% if audit.domain_rating is defined and audit.domain_rating %}
      {% set words = audit.domain_rating.split(' ') %}
      {% set half_words = (words | length // 2) %}
      {% if limited_view %}
      <div class="relative">
        <p class="text-sm text-gray-300 leading-relaxed">{{ words[:half_words] | join(' ') }} <span class="blurred-text select-none">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</span></p>
        <div class="absolute bottom-0 left-0 right-0 h-[60%] bg-gradient-to-t from-[#2a2a2a] via-[#2a2a2a]/80 to-transparent flex flex-col items-center justify-end pb-4 pointer-events-auto">
          <div class="text-center">
            <i data-lucide="lock" class="w-5 h-5 text-[#fca5a5] mx-auto mb-2"></i>
            <p class="text-white font-bold text-sm mb-1">Upgrade to Unlock</p>
            <a href="/billing/checkout" onclick="window?.datafast?.('upgrade_clicked')" class="inline-block bg-[#fca5a5] text-black px-4 py-1.5 text-xs font-bold border-2 border-[#444] shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">Upgrade to Pro</a>
          </div>
        </div>
      </div>
      {% else %}
      <p class="text-sm text-gray-300 leading-relaxed">{{ audit.domain_rating }}</p>
      {% endif %}
    {% else %}
    <div class="bg-[#1F1F1F] border border-[#444] p-4">
      <p class="text-sm text-gray-500 italic">This scan was run before we introduced this feature.</p>
    </div>
    {% endif %}
  </div>
</section>

<!-- Ideal Customer Profiles -->
<section class="mb-10 fade-up fade-up-3">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6 md:p-8">
    <div class="flex items-center gap-2 mb-4">
  <div>
    <h3 class="text-xl font-black text-white">Ideal Customer Profile</h3>
    <h4 class="text-sm font-medium text-gray-400 mt-1">
      People who need {{ domain }}
    </h4>
  </div>
</div>
    {% set icps = audit.get('ideal_customer_profiles', []) if audit.get('ideal_customer_profiles') else [] %}
    {% if icps %}
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      {% for icp in icps if icp is mapping %}
      <div class="bg-[#1F1F1F] border border-[#444] p-4">
        {% if limited_view and loop.index > 1 %}
        <p class="text-sm font-bold text-white mb-2 blurred-text select-none">Lorem ipsum dolor</p>
        <p class="text-xs text-gray-400 leading-relaxed blurred-text select-none">Consectetur adipiscing elit sed do eiusmod tempor incididunt.</p>
        {% else %}
        <p class="text-sm font-bold text-white mb-2">{{ icp.profile | default('') }}</p>
        <p class="text-xs text-gray-400 leading-relaxed">{{ icp.why | default('') }}</p>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="bg-[#1F1F1F] border border-[#444] p-4">
      <p class="text-sm text-gray-500 italic">This scan was run before we introduced this feature.</p>
    </div>
    {% endif %}
  </div>
</section>

<!-- Recommended Subreddits -->
<section class="mb-10 fade-up fade-up-4">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6 md:p-8">
    <div class="flex items-center gap-2 mb-4">
<img 
  src="https://redditinc.com/hs-fs/hubfs/Reddit%20Inc/Content/Brand%20Page/Reddit_Logo.png?width=200&height=200&name=Reddit_Logo.png" 
  class="w-8 h-auto"
/>

  <div>
    <h3 class="text-xl font-black text-white">Recommended Subreddits</h3>
    <h4 class="text-sm font-medium text-gray-400 mt-1">
      Best Subreddits to market <span>{{ domain }}</span>
    </h4>
  </div>
</div>

    {% set subreddits = audit.get('recommended_subreddits', []) if audit.get('recommended_subreddits') else [] %}
    {% if subreddits %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      {% for sub in subreddits if sub is mapping %}
      <div class="bg-[#1F1F1F] border border-[#444] p-3 flex items-start gap-3">
        {% if limited_view and loop.index > 2 %}
        <span class="fm text-xs text-[#fca5a5] font-bold whitespace-nowrap mt-0.5 blurred-text select-none">r/LoremIpsum</span>
        <p class="text-xs text-gray-400 blurred-text select-none">Consectetur adipiscing elit tempor incididunt.</p>
        {% else %}
        <span class="fm text-xs text-[#fca5a5] font-bold whitespace-nowrap mt-0.5">{{ sub.name | default('') }}</span>
        <p class="text-xs text-gray-400">{{ sub.reason | default('') }}</p>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="bg-[#1F1F1F] border border-[#444] p-4">
      <p class="text-sm text-gray-500 italic">This scan was run before we introduced this feature.</p>
    </div>
    {% endif %}
  </div>
</section>

<!-- Copy Changes -->
<section class="mb-10">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6 md:p-8">
    <h3 class="text-xl font-black text-white mb-2">Copy Changes to Increase Customers</h3>
    <p class="text-sm text-gray-400 mb-6">Targeted text swaps to improve clarity and conversion intent.</p>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
      {% set copy_changes = audit.conversion.copy_changes if audit.conversion and audit.conversion.copy_changes else [] %}
      {% if not copy_changes %}
      <div class="lg:col-span-2 bg-[#1F1F1F] border border-[#444] p-6 text-center">
        <i data-lucide="check-circle" class="w-8 h-8 text-green-400 mx-auto mb-2"></i>
        <p class="text-sm text-gray-400">No copy changes needed — your copy looks great!</p>
      </div>
      {% else %}
      {% for change in copy_changes %}
      {% if change is mapping %}
      <div class="bg-[#1F1F1F] border border-[#444] p-4">
        <div class="flex items-center justify-between mb-2">
          <span class="fm text-[10px] uppercase text-gray-500">{{ change.location | default('Copy Change') }}</span>
          {% if change.expected_impact %}<span class="fm text-[10px] px-2 py-0.5 bg-green-500/20 text-green-400 border border-green-500/30">{{ change.expected_impact }}</span>{% endif %}
        </div>
        <div class="grid grid-cols-1 gap-3">
          <div class="border border-[#333] p-3">
            <p class="fm text-[10px] uppercase text-gray-500 mb-1">Current</p>
            <p class="text-sm text-gray-300">"{{ change.original_text | default('') }}"</p>
          </div>
          <div class="border border-[#fca5a5]/30 p-3">
            <p class="fm text-[10px] uppercase text-[#fca5a5] mb-1">Suggested</p>
            {% if limited_view and loop.index > 3 %}
            <p class="text-sm text-[#fca5a5] blurred-text">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</p>
            {% else %}
            <p class="text-sm text-[#fca5a5]">"{{ change.suggested_text | default('') }}"</p>
            {% endif %}
          </div>
        </div>
        {% if change.reasoning %}<p class="text-xs text-gray-400 mt-3">{{ change.reasoning }}</p>{% endif %}
      </div>
      {% endif %}
      {% endfor %}
      {% endif %}
    </div>
  </div>
</section>

<!-- Quick Stats -->
<section class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-10">
  {% set cta = audit.conversion.cta_analysis if audit.conversion and audit.conversion.cta_analysis else {} %}
  {% set stats = [
    ('Issues Found', ns.total, ns.critical ~ ' critical'),
    ('Scan Speed', dur ~ 's', 'Time to process audit'),
    ('CTA Count', cta.total_ctas | default(0), cta.overall_effectiveness | default('N/A'))
  ] %}
  {% for label, val, sub in stats %}
  <div class="fade-up bg-[#2a2a2a] border-2 border-[#444] p-4" style="animation-delay:{{ loop.index * 0.05 }}s">
    <p class="fm text-[10px] uppercase text-gray-500 mb-1">{{ label }}</p>
    <p class="text-2xl font-black text-white">{{ ('—' if obfuscate else val) }}</p>
    <p class="text-xs text-gray-500 mt-1">{{ ('Sign in to view details.' if obfuscate else sub) }}</p>
  </div>
  {% endfor %}
</section>

<!-- Top Keywords -->
<section class="mb-10 fade-up">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6 md:p-8">
    <div class="flex items-center gap-2 mb-4">
      <i data-lucide="hash" class="w-5 h-5 text-[#fca5a5]"></i>
      <h3 class="text-xl font-black text-white">Top Keywords</h3>
    </div>
    <p class="text-sm text-gray-400 mb-5">Most frequent keywords found in the visible page content.</p>
    {% set kw_list = audit.top_keywords if audit.top_keywords is defined and audit.top_keywords else [] %}
    {% if not kw_list %}
    <div class="bg-[#1F1F1F] border border-[#444] p-4">
      <p class="text-sm text-gray-500 italic">This scan was run before we introduced this feature.</p>
    </div>
    {% else %}
    {% set max_count = kw_list[0].count if kw_list else 1 %}
    {% set kw_total = kw_list | length %}
    <div class="space-y-3">
      {% for kw in kw_list %}
      {% set kw_visible = not limited_view or loop.index == 1 or loop.index == kw_total %}
      <div class="flex items-center gap-4">
        {% if kw_visible %}
        <span class="fm text-sm text-gray-300 w-28 truncate">{{ kw.keyword }}</span>
        {% else %}
        <span class="fm text-sm text-gray-300 w-28 truncate blurred-text select-none">loremipsum</span>
        {% endif %}
        <div class="flex-1 h-6 bg-[#1F1F1F] border border-[#444] overflow-hidden relative">
          <div class="h-full bg-[#fca5a5]/20 bar" style="width:{{ (kw.count / max_count * 100) | round(1) }}%"></div>
        </div>
        <span class="fm text-xs text-gray-400 w-10 text-right">{{ kw.count }}×</span>
      </div>
      {% endfor %}
    </div>
    {% endif %}
  </div>
</section>

<!-- Issue distribution + severity pies -->
<section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-10">
  <!-- Pie chart -->
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6">
    <h3 class="fm text-[10px] uppercase text-gray-500 mb-5">Issues by Category</h3>
    {% set cats = ns.cats %}
    {% set total = safe_total %}
    {% set colors = {'seo':'#fca5a5','conversion':'#f59e0b','security':'#ef4444','other':'#9ca3af'} %}
    <div class="flex items-center justify-center">
      <div class="relative w-40 h-40">
        <svg viewBox="0 0 100 100" class="w-full h-full -rotate-90">
          {% set ns_cat = namespace(offset=0) %}
          {% for cat, count in cats.items() %}
          {% set pct = count / total * 251.33 %}
          <circle cx="50" cy="50" r="40" fill="none" stroke-width="20" stroke="{{ colors.get(cat, '#666') }}" stroke-dasharray="{{ pct }} {{ 251.33 - pct }}" stroke-dashoffset="{{ -ns_cat.offset }}"/>
          {% set ns_cat.offset = ns_cat.offset + pct %}
          {% endfor %}
        </svg>
      </div>
    </div>
    <div class="grid grid-cols-2 gap-2 mt-5">
      {% for cat, count in cats.items() %}
      <div class="flex items-center gap-2"><span class="w-3 h-3 rounded-sm" style="background:{{ colors.get(cat,'#666') }}"></span><span class="text-xs text-gray-400">{{ cat | capitalize }} ({{ count }})</span></div>
      {% endfor %}
    </div>
  </div>

  <!-- Severity pie -->
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6">
    <h3 class="fm text-[10px] uppercase text-gray-500 mb-5">Issues by Severity</h3>
    {% set sev_counts = {
      'critical': ns.critical,
      'high': ns.high,
      'medium': ns.medium,
      'low': ns.low
    } %}
    {% set sev_colors = {'critical':'#ef4444','high':'#f97316','medium':'#f59e0b','low':'#3b82f6'} %}
    <div class="flex items-center justify-center">
      <div class="relative w-40 h-40">
        <svg viewBox="0 0 100 100" class="w-full h-full -rotate-90">
          {% set ns2 = namespace(offset=0) %}
          {% for sev, count in sev_counts.items() %}
          {% set pct = (count / safe_total) * 251.33 %}
          <circle cx="50" cy="50" r="40" fill="none" stroke-width="20" stroke="{{ sev_colors.get(sev, '#666') }}" stroke-dasharray="{{ pct }} {{ 251.33 - pct }}" stroke-dashoffset="{{ -ns2.offset }}"/>
          {% set ns2.offset = ns2.offset + pct %}
          {% endfor %}
        </svg>
      </div>
    </div>
    <div class="grid grid-cols-2 gap-2 mt-5">
      {% for sev, count in sev_counts.items() %}
      <div class="flex items-center gap-2"><span class="w-3 h-3 rounded-sm" style="background:{{ sev_colors.get(sev,'#666') }}"></span><span class="text-xs text-gray-400">{{ sev | capitalize }} ({{ count }})</span></div>
      {% endfor %}
    </div>
  </div>

  <!-- Site preview -->
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6">
    <h3 class="fm text-[10px] uppercase text-gray-500 mb-5">Site Preview</h3>
    <div class="aspect-video bg-[#1F1F1F] border border-[#444] overflow-hidden">
      <iframe src="{{ audit.url }}" class="w-full h-full" loading="lazy" referrerpolicy="no-referrer"></iframe>
    </div>
    <p class="text-xs text-gray-500 mt-3">Preview may be blocked by some sites that disallow iframes.</p>
  </div>
</section>
<!-- SEO -->
<section class="mb-10">
  <div id="tab-seo" class="tab-c active">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="lg:col-span-2 space-y-4">
        <h3 class="text-xl font-black text-white mb-1">SEO Analysis</h3>
        <p class="text-sm text-gray-400 mb-4">{{ audit.seo.summary if audit.seo else 'N/A' }}</p>

        {% set seo_elements = audit.seo.elements if audit.seo and audit.seo.elements else {} %}
        {% if not seo_elements %}
        <div class="bg-[#1F1F1F] border border-[#444] p-6 text-center">
          <i data-lucide="check-circle" class="w-8 h-8 text-green-400 mx-auto mb-2"></i>
          <p class="text-sm text-gray-400">No SEO elements to analyze.</p>
        </div>
        {% else %}
        {% for key, el in seo_elements.items() if el is mapping %}
        <div class="bg-[#2a2a2a] border-2 border-[#444]">
          <div class="px-5 py-3 border-b border-[#444] flex items-center justify-between">
            <div class="flex items-center gap-3">
              <span class="w-2.5 h-2.5 rounded-full dot-{{ el.status }} flex-shrink-0"></span>
              <span class="fm text-xs uppercase text-gray-300">{{ key | replace('_', ' ') }}</span>
            </div>
            <span class="fm text-[10px] uppercase {% if el.status == 'passed' %}text-green-400{% elif el.status == 'warning' %}text-yellow-400{% else %}text-red-400{% endif %}">{{ el.status }}</span>
          </div>
          <div class="px-5 py-4">
            {% if el.value is not none and el.value != true %}
            <p class="fm text-xs text-gray-500 mb-2 break-all">{{ el.value }}</p>
            {% elif el.value == true %}
            <p class="fm text-xs text-green-400 mb-2">Enabled</p>
            {% endif %}
            {% if el.get('length') %}<p class="text-xs text-gray-500">{{ el.length }} characters</p>{% endif %}
            {% if el.get('images_without_alt') %}<p class="text-xs text-gray-500">{{ el.images_with_alt }}/{{ el.total_images }} images have alt text</p>{% endif %}
            <p class="text-xs text-gray-400 mt-2">{{ el.why_important }}</p>
            {% if el.recommendation %}
            <div class="mt-3 bg-[#1F1F1F] border border-[#444] p-3 rounded">
              <p class="fm text-[10px] text-gray-500 mb-1">Recommendation:</p>
              <p class="text-xs text-[#fca5a5]">{{ el.recommendation }}</p>
              {% if el.get('suggested_value') %}
              <code class="block mt-2 fm text-[11px] text-gray-300 bg-[#2a2a2a] p-2 border border-[#444] break-all">{{ el.suggested_value }}</code>
              {% endif %}
            </div>
            {% endif %}
          </div>
        </div>
        {% endfor %}
        {% endif %}
      </div>

      <!-- SEO Checklist sidebar -->
      <div>
        <h3 class="text-xl font-black text-white mb-4">SEO Checklist</h3>
        <div class="bg-[#2a2a2a] border-2 border-[#444] divide-y divide-[#333]">
          {% if not seo_elements %}
          <div class="px-4 py-6 text-center">
            <p class="text-sm text-gray-500">No checklist items available.</p>
          </div>
          {% else %}
          {% for key, el in seo_elements.items() if el is mapping %}
          <div class="px-4 py-3 flex items-center gap-3">
            {% if el.status == 'passed' %}<i data-lucide="check-circle" class="w-4 h-4 text-green-400 flex-shrink-0"></i>
            {% elif el.status == 'warning' %}<i data-lucide="alert-circle" class="w-4 h-4 text-yellow-400 flex-shrink-0"></i>
            {% else %}<i data-lucide="x-circle" class="w-4 h-4 text-red-400 flex-shrink-0"></i>{% endif %}
            <span class="text-sm text-gray-300">{{ key | replace('_', ' ') | title }}</span>
          </div>
          {% endfor %}
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Security -->
<section class="mb-10">
  <div id="tab-security" class="tab-c active">
    <h3 class="text-xl font-black text-white mb-1">Security Audit</h3>
    {% set sec = audit.security if audit.security else {} %}
    <p class="text-sm text-gray-400 mb-6">{{ sec.summary | default('N/A') }} &middot; Risk level: <span class="font-bold {% if sec.overall_risk == 'low' %}text-green-400{% elif sec.overall_risk == 'medium' %}text-yellow-400{% else %}text-red-400{% endif %}">{{ (sec.overall_risk | default('unknown')) | upper }}</span></p>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
      {% set sec_checks = sec.checks or {} %}
      {% if not sec_checks %}
      <div class="md:col-span-2 lg:col-span-3 bg-[#1F1F1F] border border-[#444] p-6 text-center">
        <i data-lucide="shield-check" class="w-8 h-8 text-green-400 mx-auto mb-2"></i>
        <p class="text-sm text-gray-400">No security checks were performed for this scan.</p>
      </div>
      {% else %}
      {% for check_id, check in sec_checks.items() %}
      <div class="bg-[#2a2a2a] border-2 border-[#444] p-4">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm text-gray-300 font-medium">{{ check_id | replace('_', ' ') | title }}</span>
          {% if check.status == 'passed' %}
          <span class="fm text-[10px] px-2 py-0.5 bg-green-500/20 text-green-400 border border-green-500/30 uppercase font-bold">Passed</span>
          {% elif check.status == 'warning' %}
          <span class="fm text-[10px] px-2 py-0.5 bg-yellow-500/20 text-yellow-400 border border-yellow-500/30 uppercase font-bold">Warning</span>
          {% else %}
          <span class="fm text-[10px] px-2 py-0.5 bg-red-500/20 text-red-400 border border-red-500/30 uppercase font-bold">Failed</span>
          {% endif %}
        </div>
        <p class="text-xs text-gray-500 mb-2">{{ check.description }}</p>
        {% if check.recommendation %}
        {% if limited_view %}
        <p class="text-xs text-[#fca5a5] blurred-text">Lorem ipsum dolor sit amet.</p>
        {% else %}
        <p class="text-xs text-[#fca5a5]">{{ check.recommendation }}</p>
        {% endif %}
        {% endif %}
      </div>
      {% endfor %}
      {% endif %}
    </div>


  </div>
</section>

<!-- All Issues Table -->
<section class="mb-10">
  <div class="flex items-center justify-between mb-4">
  <h3 class="text-xl font-black text-white">All Issues ({{ ns.total }})</h3>
    <div class="flex gap-2">
      <button class="fm text-[10px] px-3 py-1.5 bg-[#2a2a2a] border border-[#444] text-gray-400 hover:text-white transition-colors" onclick="filterIssues('all')">All</button>
      <button class="fm text-[10px] px-3 py-1.5 bg-[#2a2a2a] border border-[#444] sev-critical" onclick="filterIssues('critical')">Critical ({{ ns.critical }})</button>
      <button class="fm text-[10px] px-3 py-1.5 bg-[#2a2a2a] border border-[#444] sev-high" onclick="filterIssues('high')">High ({{ ns.high }})</button>
      <button class="fm text-[10px] px-3 py-1.5 bg-[#2a2a2a] border border-[#444] sev-medium" onclick="filterIssues('medium')">Medium ({{ ns.medium }})</button>
      <button class="fm text-[10px] px-3 py-1.5 bg-[#2a2a2a] border border-[#444] sev-low" onclick="filterIssues('low')">Low ({{ ns.low }})</button>
    </div>
  </div>

  <div class="bg-[#2a2a2a] border-2 border-[#444] overflow-hidden">
    {% if ns.total == 0 %}
    <div class="px-5 py-10 text-center">
      <i data-lucide="check-circle" class="w-10 h-10 text-green-400 mx-auto mb-3"></i>
      <p class="text-lg font-bold text-white mb-1">No issues found!</p>
      <p class="text-sm text-gray-400">Your site passed all checks. Great job!</p>
    </div>
    {% else %}
    <div class="grid grid-cols-12 gap-4 px-5 py-3 border-b-2 border-[#444] text-gray-500">
      <div class="col-span-1 fm text-[10px] uppercase"></div>
      <div class="col-span-5 fm text-[10px] uppercase">Issue</div>
      <div class="col-span-2 fm text-[10px] uppercase hidden md:block">Category</div>
      <div class="col-span-2 fm text-[10px] uppercase hidden md:block">Severity</div>
      <div class="col-span-2 fm text-[10px] uppercase hidden md:block">Impact</div>
    </div>
    {% for item in audit.issues['items'] if item is mapping %}
    <div class="issue-row issue-sev-{{ item.severity }} grid grid-cols-12 gap-4 px-5 py-4 border-b border-[#333] items-start">
      <div class="col-span-1"><span class="w-2.5 h-2.5 rounded-full dot-{{ item.severity }} inline-block mt-1"></span></div>
      <div class="col-span-5">
        <p class="text-sm text-gray-200">{{ item.name }}</p>
        <div class="issue-detail mt-3 space-y-2">
          <p class="text-xs text-gray-400">{{ item.description }}</p>
          <div class="bg-[#1F1F1F] border border-[#444] p-3 rounded">
            <p class="fm text-[10px] text-gray-500 mb-1">Fix:</p>
            {% if limited_view and loop.index > 1 %}
            <p class="text-xs text-[#fca5a5] blurred-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
            {% else %}
            <p class="text-xs text-[#fca5a5]">{{ item.solution }}</p>
            {% endif %}
            {% if item.code_example %}
            {% if limited_view and loop.index > 1 %}
            <code class="block mt-2 fm text-[11px] text-gray-300 bg-[#2a2a2a] p-2 border border-[#444] whitespace-pre-wrap blurred-text">// Lorem ipsum dolor sit amet</code>
            {% else %}
            <code class="block mt-2 fm text-[11px] text-gray-300 bg-[#2a2a2a] p-2 border border-[#444] whitespace-pre-wrap">{{ item.code_example }}</code>
            {% endif %}
            {% endif %}
          </div>
          {% for el in item.affected_elements %}
          <p class="fm text-[10px] text-gray-500">{{ el.location | default('') }} &middot; {{ el.selector | default('') }}</p>
          {% endfor %}
        </div>
      </div>
      <div class="col-span-2 hidden md:block"><span class="fm text-xs text-gray-500">{{ item.category | capitalize }}</span></div>
      <div class="col-span-2 hidden md:block"><span class="fm text-[10px] sev-{{ item.severity }} uppercase font-bold">{{ item.severity }}</span></div>
      <div class="col-span-2 hidden md:block"><p class="text-xs text-gray-500 line-clamp-2">{{ item.impact }}</p></div>
    </div>
    {% endfor %}
    {% endif %}
  </div>
</section>



<!-- AI Fix Prompt -->
{% if llm_prompt %}
{% set prompt_lines = llm_prompt.split('\n') %}
{% set total_lines = prompt_lines | length %}
{% set half = (total_lines // 4) %}
<section class="mb-10">
  <div class="bg-[#2a2a2a] border-2 border-[#444] p-6 md:p-8">
    <div class="flex items-center justify-between mb-2">
      <h3 class="text-xl font-black text-white flex items-center gap-2"><i data-lucide="sparkles" class="w-5 h-5 text-[#fca5a5]"></i> AI Fix Prompt</h3>
      {% if not limited_view %}
      <button onclick="copyPrompt()" id="copy-prompt-btn" class="flex items-center gap-2 text-gray-400 hover:text-white text-sm fm transition-colors"><i data-lucide="copy" class="w-4 h-4"></i> <span id="copy-prompt-text">Copy</span></button>
      {% endif %}
    </div>
    <p class="text-sm text-gray-400 mb-5">Auto-generated prompt based on your audit results. Paste it into Claude, Cursor, or your favourite vibecoding tool to get a fully fixed version of your website.</p>

    <div class="relative">
      <pre id="llm-prompt-block" class="bg-[#1F1F1F] border border-[#444] p-4 fm text-[12px] text-gray-300 whitespace-pre-wrap overflow-x-auto max-h-[500px] overflow-y-auto leading-relaxed">{% for line in prompt_lines[:half] %}{{ line }}
{% endfor %}{% if limited_view %}<span class="blurred-text select-none">{% for _ in prompt_lines[half:] %}Upgrade to unlock — Upgrade to unlock — Upgrade to unlock
{% endfor %}</span>{% else %}{% for line in prompt_lines[half:] %}{{ line }}
{% endfor %}{% endif %}</pre>

      {% if limited_view %}
      <!-- Upgrade overlay covering the bottom half -->
      <div class="absolute bottom-0 left-0 right-0 h-[55%] bg-gradient-to-t from-[#2a2a2a] via-[#2a2a2a]/95 to-transparent flex flex-col items-center justify-end pb-8 pointer-events-auto">
        <div class="text-center">
          <i data-lucide="lock" class="w-8 h-8 text-[#fca5a5] mx-auto mb-3"></i>
          <p class="text-white font-bold text-lg mb-1">Upgrade to Unlock Full Prompt</p>
          <p class="text-gray-400 text-sm mb-4 max-w-sm">Get the complete AI fix prompt with all issues, copy changes, security fixes, and code patches.</p>
          <a href="/billing/checkout" onclick="window?.datafast?.('upgrade_clicked')" class="inline-block bg-[#fca5a5] text-black px-6 py-2.5 font-bold border-2 border-[#444] shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">Upgrade to Pro</a>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</section>
{% endif %}

<!-- Bottom CTA / Pricing -->
{% if limited_view %}
<section class="bg-[#2a2a2a] border-2 border-[#444] p-8 md:p-12 mb-10">
  <div class="max-w-4xl mx-auto text-center">
    <span class="inline-block bg-[#fca5a5] text-black px-3 py-1 border border-[#444] fm text-[10px] font-bold mb-4">PRO</span>
    <h3 class="text-2xl md:text-3xl font-black text-white mb-2">Unlock the Full Report</h3>
    <section id="pricing" class="py-16 md:py-24 px-4 md:px-12 border-y border-[#333]">
    <div class="max-w-5xl mx-auto">


      <div class="grid md:grid-cols-2 gap-8 items-start">

        <div class="flex flex-col justify-center items-center">
          <h3 class="text-3xl md:text-4xl font-black mb-6 text-white text-center">One Simple Plan.<br>Simple Pricing.<br>All Features.</h3>

          <div class="bg-[#2a2a2a] border-2 border-[#444] shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] overflow-hidden w-full max-w-[240px]">
            <video
              class="w-full"
              style="aspect-ratio: 9/16;"
              src="{{ url_for('static', filename='vids/rushilreview.mp4') }}"
              controls
              playsinline
              preload="metadata"
            ></video>
            <div class="p-3 flex items-center gap-3 border-t-2 border-[#444]">
              <div class="w-8 h-8 border-2 border-[#444] rounded-full overflow-hidden flex-shrink-0">
                <img src="https://ca.slack-edge.com/E09V59WQY1E-U020X4GCWSF-253b77f85aa8-192" alt="Rushil Chopra" class="w-full h-full object-cover">
              </div>
              <div>
                <p class="font-bold text-xs text-white">Rushil Chopra</p>
                <p class="text-gray-500 text-[10px]">Founder @ Agathon · Silicon Valley</p>
              </div>
            </div>
          </div>
          <br>
          <p class="text-gray-400 text-xs mt-3 text-center">
            <i data-lucide="arrow-up" class="w-3 h-3 inline-block mb-0.5 text-gray-500"></i>
            feedback from an AI startup founder using <span class="font-black text-white">fixmy<span class="text-[#fca5a5]">land<span class="text-white">.</span>ing</span></span>
          </p>
        </div>

        <div class="bg-[#2a2a2a] border-2 border-[#444] p-8 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]
               hover:translate-x-0.5 hover:translate-y-0.5 transition-all
               flex flex-col relative">


          <span class="inline-block bg-[#fca5a5] text-black px-3 py-1 border border-[#444] font-mono text-xs font-bold mb-4">PRO</span>
          <p class="text-gray-400 font-medium mb-6">
            Perfect for founders, marketers, and freelancers.
          </p>

          <div class="text-4xl font-black mb-6 text-white">
            <span>$5</span>
            <span class="text-base font-medium text-gray-400"> / month</span>
          </div>

          <ul class="space-y-3 text-sm font-medium mb-8">
            <li class="text-red-400">&#10003; 15 audits per month</li>
            <li class="text-red-400">&#10003; Conversion analysis</li>
            <li class="text-red-400">&#10003; SEO scoring & recommendations</li>
            <li class="text-red-400">&#10003; Ideal customer profiles</li>
            <li class="text-red-400">&#10003; Recommended subreddits</li>
            <li class="text-red-400">&#10003; Priority 24/7 support</li>
            <li class="text-red-400">&#10003; Faster & Smarter AI Model</li>
            <li class="text-red-400">&#10003; Scan larger websites</li>
            <li class="text-red-400">&#10003; View all issues solutions</li>
            <li class="text-red-400">&#10003; View all issues code patches</li>
            <li class="text-red-400">&#10003; View all copy changed text</li>
            <li class="text-red-400">&#10003; Full AI fix prompt</li>
          </ul>

          <a href="/billing/checkout" onclick="window?.datafast?.('upgrade_clicked')" class="nf-shimmer mt-auto block text-center bg-[#fca5a5] text-black border-2 border-[#444] py-3 font-bold
                 brutalist-shadow-sm hover:translate-x-0.5 hover:translate-y-0.5 transition-all">
           Upgrade Now →
          </a>
        </div>

      </div>
    </div>
  </section>
  </div>
</section>
{% else %}
<section class="bg-[#2a2a2a] border-2 border-[#444] p-8 md:p-12 text-center mb-10">
  <h3 class="text-2xl md:text-3xl font-black text-white mb-2">{{ ns.total }} issues found on {{ domain }}</h3>
  <p class="text-gray-400 mb-6 max-w-lg mx-auto">{{ s.overall.summary }}</p>
  <div class="flex flex-col sm:flex-row gap-4 justify-center">
    <a href="/#scan" class="bg-[#fca5a5] text-black px-8 py-3 font-bold border-2 border-[#444] shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all">Run Another Audit</a>
  </div>
</section>
{% endif %}
</div>
</main>
{% endif %}

{% if limited_view %}
<!-- Exit-intent promo overlay -->
<div id="exit-promo" class="fixed inset-0 z-[999] flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 opacity-0 pointer-events-none" style="display:none;">
  <div class="bg-[#2a2a2a] border-2 border-[#444] shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] p-8 md:p-10 max-w-md w-full mx-4 text-center relative">
    <button onclick="closeExitPromo()" class="absolute top-3 right-3 text-gray-500 hover:text-white transition-colors"><i data-lucide="x" class="w-5 h-5"></i></button>
    <span class="inline-block bg-[#fca5a5] text-black px-3 py-1 border border-[#444] fm text-[10px] font-bold mb-4">SPECIAL OFFER</span>
    <h3 class="text-2xl font-black text-white mb-2">Wait — Don't Leave Yet</h3>
    <p class="text-gray-400 text-sm mb-5">You're viewing a limited report. Upgrade to Pro to have 15 full audits per month.</p>
    <div class="bg-[#1F1F1F] border border-dashed border-[#fca5a5] p-4 mb-5">
      <p class="fm text-[10px] uppercase text-gray-500 mb-1">Promo Code</p>
      <div class="flex items-center justify-center gap-3">
        <span id="promo-code" class="fm text-xl font-bold text-[#fca5a5] tracking-widest select-all">MINUS10</span>
        <button onclick="copyPromo()" id="copy-promo-btn" class="text-gray-400 hover:text-white transition-colors" title="Copy code"><i data-lucide="copy" class="w-4 h-4"></i></button>
      </div>
      <p id="promo-copied" class="fm text-[10px] text-green-400 mt-1 hidden">Copied to clipboard</p>
    </div>
    <a href="/billing/checkout" onclick="window?.datafast?.('upgrade_clicked')" class="block bg-[#fca5a5] text-black py-3 font-bold border-2 border-[#444] shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all mb-3">Upgrade Now — Discounted</a>
    <button onclick="closeExitPromo()" class="text-gray-500 hover:text-white text-xs fm transition-colors">No thanks, I'll stay limited</button>
  </div>
</div>
{% endif %}

<footer class="border-t border-[#333] px-4 md:px-8 py-6 text-center">
  <div class="flex flex-col items-center gap-3">
    <span class="text-xl md:text-2xl font-black tracking-tighter text-white">fixmy<span class="text-[#fca5a5]">land<span class="text-white">.</span>ing</span>
    <div class="flex flex-col md:flex-row items-center justify-center gap-3 fm text-[10px] text-gray-500 uppercase">
      <div class="flex items-center gap-3">
        <a href="/terms" class="hover:text-white transition-colors">Terms</a>
        <span class="text-gray-700">•</span>
        <a href="/privacy" class="hover:text-white transition-colors">Privacy</a>
        <span class="text-gray-700">•</span>
        <a href="/contact" class="hover:text-white transition-colors">Contact</a>
      </div>
      <span class="text-gray-600">&copy; 2026 FixMyLanding</span>
    </div>
  </div>
</footer>

<script>
  lucide.createIcons();
  function filterIssues(s){document.querySelectorAll('[class*="issue-sev-"]').forEach(r=>{if(s==='all'){r.style.display='';}else{r.style.display=r.classList.contains('issue-sev-'+s)?'':'none';}});}
  // Exit-intent promo for free tier
  (function(){
    var promo=document.getElementById('exit-promo');
    if(!promo)return;
    var shown=false, dismissed=false;
    function showPromo(){
      if(shown||dismissed)return;
      shown=true;
      window?.datafast?.("exit_promo_shown");
      promo.style.display='flex';
      requestAnimationFrame(function(){
        promo.classList.remove('opacity-0','pointer-events-none');
        promo.classList.add('opacity-100');
      });
      lucide.createIcons();
    }
    document.addEventListener('mouseleave',function(e){
      if(e.clientY<=0)showPromo();
    });
    window.closeExitPromo=function(){
      promo.classList.remove('opacity-100');
      promo.classList.add('opacity-0','pointer-events-none');
      setTimeout(function(){promo.style.display='none';},300);
      dismissed=true;
    };
    window.copyPromo=function(){
      navigator.clipboard.writeText('MINUS10').then(function(){
        var msg=document.getElementById('promo-copied');
        msg.classList.remove('hidden');
        setTimeout(function(){msg.classList.add('hidden');},2000);
      });
    };
  })();

  function copyPrompt(){
    var el=document.getElementById('llm-prompt-block');
    if(!el)return;
    navigator.clipboard.writeText(el.innerText).then(function(){
      var t=document.getElementById('copy-prompt-text');
      t.textContent='Copied!';
      setTimeout(function(){t.textContent='Copy';},2000);
    });
  }

  function copyShareLink(){
    var url={{ (share_url or '') | tojson }};
    if(!url)return;
    navigator.clipboard.writeText(url).then(function(){
      var t=document.getElementById('share-btn-text');
      t.textContent='Copied!';
      setTimeout(function(){t.textContent='Share';},2000);
    });
  }
</script>
</body>
</html>
